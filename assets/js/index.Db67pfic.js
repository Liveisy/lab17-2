/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var g=O,u=m,p=Object.prototype.toString,f=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function O(t,n){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var i={},e=n||{},r=e.decode||b,o=0;o<t.length;){var s=t.indexOf("=",o);if(s===-1)break;var a=t.indexOf(";",o);if(a===-1)a=t.length;else if(a<s){o=t.lastIndexOf(";",s-1)+1;continue}var c=t.slice(o,s).trim();if(i[c]===void 0){var h=t.slice(s+1,a).trim();h.charCodeAt(0)===34&&(h=h.slice(1,-1)),i[c]=S(h,r)}o=a+1}return i}function m(t,n,i){var e=i||{},r=e.encode||y;if(typeof r!="function")throw new TypeError("option encode is invalid");if(!f.test(t))throw new TypeError("argument name is invalid");var o=r(n);if(o&&!f.test(o))throw new TypeError("argument val is invalid");var s=t+"="+o;if(e.maxAge!=null){var a=e.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+Math.floor(a)}if(e.domain){if(!f.test(e.domain))throw new TypeError("option domain is invalid");s+="; Domain="+e.domain}if(e.path){if(!f.test(e.path))throw new TypeError("option path is invalid");s+="; Path="+e.path}if(e.expires){var c=e.expires;if(!w(c)||isNaN(c.valueOf()))throw new TypeError("option expires is invalid");s+="; Expires="+c.toUTCString()}if(e.httpOnly&&(s+="; HttpOnly"),e.secure&&(s+="; Secure"),e.partitioned&&(s+="; Partitioned"),e.priority){var h=typeof e.priority=="string"?e.priority.toLowerCase():e.priority;switch(h){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(e.sameSite){var d=typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite;switch(d){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return s}function b(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function y(t){return encodeURIComponent(t)}function w(t){return p.call(t)==="[object Date]"||t instanceof Date}(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="468694a2-019a-4216-8b90-703282317453",t._sentryDebugIdIdentifier="sentry-dbid-468694a2-019a-4216-8b90-703282317453")}catch{}})();function S(t,n){try{return n(t)}catch{return t}}function k(){const t=typeof global>"u"?void 0:global.TEST_HAS_DOCUMENT_COOKIE;return typeof t=="boolean"?t:typeof document=="object"&&typeof document.cookie=="string"}function v(t){return typeof t=="string"?g(t):typeof t=="object"&&t!==null?t:{}}function l(t,n={}){const i=C(t);if(!n.doNotParse)try{return JSON.parse(i)}catch{}return t}function C(t){return t&&t[0]==="j"&&t[1]===":"?t.substr(2):t}class _{constructor(n,i={}){this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.update=()=>{if(!this.HAS_DOCUMENT_COOKIE)return;const r=this.cookies;this.cookies=g(document.cookie),this._checkChanges(r)};const e=typeof document>"u"?"":document.cookie;this.cookies=v(n||e),this.defaultSetOptions=i,this.HAS_DOCUMENT_COOKIE=k()}_emitChange(n){for(let i=0;i<this.changeListeners.length;++i)this.changeListeners[i](n)}_checkChanges(n){new Set(Object.keys(n).concat(Object.keys(this.cookies))).forEach(e=>{n[e]!==this.cookies[e]&&this._emitChange({name:e,value:l(this.cookies[e])})})}_startPolling(){this.pollingInterval=setInterval(this.update,300)}_stopPolling(){this.pollingInterval&&clearInterval(this.pollingInterval)}get(n,i={}){return i.doNotUpdate||this.update(),l(this.cookies[n],i)}getAll(n={}){n.doNotUpdate||this.update();const i={};for(let e in this.cookies)i[e]=l(this.cookies[e],n);return i}set(n,i,e){e?e=Object.assign(Object.assign({},this.defaultSetOptions),e):e=this.defaultSetOptions;const r=typeof i=="string"?i:JSON.stringify(i);this.cookies=Object.assign(Object.assign({},this.cookies),{[n]:r}),this.HAS_DOCUMENT_COOKIE&&(document.cookie=u(n,r,e)),this._emitChange({name:n,value:i,options:e})}remove(n,i){const e=i=Object.assign(Object.assign(Object.assign({},this.defaultSetOptions),i),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=Object.assign({},this.cookies),delete this.cookies[n],this.HAS_DOCUMENT_COOKIE&&(document.cookie=u(n,"",e)),this._emitChange({name:n,value:void 0,options:i})}addChangeListener(n){this.changeListeners.push(n),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===1&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.addEventListener("change",this.update):this._startPolling())}removeChangeListener(n){const i=this.changeListeners.indexOf(n);i>=0&&this.changeListeners.splice(i,1),this.HAS_DOCUMENT_COOKIE&&this.changeListeners.length===0&&(typeof window=="object"&&"cookieStore"in window?window.cookieStore.removeEventListener("change",this.update):this._stopPolling())}}class E{constructor(n={}){this.removeEmptyValues=i=>Object.fromEntries(Object.entries(i).filter(([e,r])=>r!=null)),this.formatUrl=i=>{const e=Object.assign({},i);e.mostRecentTraditionalDeviceId||(e.mostRecentTraditionalDeviceId=this.getDeviceId());const r=new URLSearchParams(this.removeEmptyValues(e));return`${this.path}?${r.toString()}`},this.getDeviceId=()=>this.cookies.get("cookie_id"),this.login=i=>this.formatUrl(Object.assign(Object.assign({},this.config),i)),this.register=i=>this.formatUrl(Object.assign(Object.assign(Object.assign({},this.config),i),{initialScreen:"signup"})),this.appleAuth=i=>this.formatUrl(Object.assign(Object.assign({},i),{connection:"apple"})),this.googleAuth=i=>this.formatUrl(Object.assign(Object.assign({},i),{connection:"google-oauth2"})),this.progressiveRegistration=i=>this.formatUrl(Object.assign(Object.assign({},i),{progressiveReg:"true"})),this.path="/api/nts/v1/login",this.config=n,this.cookies=new _}}export{E as L};
//# sourceMappingURL=index.Db67pfic.js.map
